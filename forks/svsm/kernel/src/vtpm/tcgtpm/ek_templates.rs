// SPDX-License-Identifier: MIT
//
// Copyright (C) Coconut-SVSM authors
//
// Author: Dionna Glaze <dionnaglaze@google.com>
//

// All constants are defined in TCG Trusted Platform Module Library Part 2 - Structures
// with the names stated in comments.
//
// Table 9. definition of TPM_ALG_ID constants:
// TPM_ALG_RSA     (0x0001)
// TPM_ALG_AES     (0x0006)
// TPM_ALG_SHA256  (0x000B)
// TPM_ALG_NULL    (0x0010)
// TPM_ALG_CFB     (0x0043)
//
// Table 33. TPMA_OBJECT bits
// fixedTPM(1)
// fixedParent(4)
// sensitiveDataOrigin(5)
// adminWithPolicy(7)
// restricted(16)
// decrypt(17)

// TPMT_PUBLIC with TCG default EK template,
// see Table 2: Default EK Template (TPMT_PUBLIC) L-1: RSA 2048 (Storage)
// of TCG EK Credential Profile For TPM Family 2.0; Level 0 Version 2.5 Revision 2
pub const DEFAULT_PUBLIC_AREA: [u8; 314] = [
    0x00, 0x01, // type TPM_ALG_RSA
    0x00, 0x0B, // nameAlg TPM_ALG_SHA256
    0x00, 0x03, 0x00, 0xb2, // objectAttributes { decrypt restricted adminWithPolicy
    // sensitiveDataOrigin fixedParent fixedTpm }
    0x00, 0x20, // authPolicy PolicyA_SHA256 (EK Credential profile)
    0x83, 0x71, 0x97, 0x67, 0x44, 0x84, 0xb3, 0xf8, 0x1a, 0x90, 0xcc, 0x8d, 0x46, 0xa5, 0xd7, 0x24,
    0xfd, 0x52, 0xd7, 0x6e, 0x06, 0x52, 0x0b, 0x64, 0xf2, 0xa1, 0xda, 0x1b, 0x33, 0x14, 0x69, 0xaa,
    // TPMS_RSA_PARMS {
    0x00, 0x06, // symmetric { algorithm TPM_ALG_AES
    0x00, 0x80, // keyBits 128
    0x00, 0x43, // mode TPM_ALG_CFB }
    0x00, 0x10, // scheme TPM_ALG_NULL
    0x08, 0x00, // keyBits 2048
    0x00, 0x00, 0x00, 0x00, // exponent (0) } TPMS_RSA_PARMS
    0x01, 0x00, // unique
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
];
